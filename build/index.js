(()=>{"use strict";const e=window.React,t=window.wp.hooks,l=window.wp.compose,n=window.wp.blockEditor,a=window.wp.element,o=window.wp.i18n,r=window.wp.components,i={tailwind:{label:"Tailwind Style",style:"solid",width:1,color:"#e5e7eb",opacity:1,lengthMode:"page",lengthPercent:100},modern:{label:"Modern Grid",style:"solid",width:1,color:"#3b82f6",opacity:.15,lengthMode:"page",lengthPercent:100},subtle:{label:"Subtle Lines",style:"dashed",width:1,color:"#000000",opacity:.05,lengthMode:"page",lengthPercent:100},custom:{label:"Custom",style:"solid",width:1,color:"#000000",opacity:.1,lengthMode:"page",lengthPercent:100}},s={enabled:!1,style:"solid",width:1,color:"#000000",opacity:.1,lengthMode:"page",lengthPercent:100},d={enabled:!1,preset:"custom",linked:!0,preventOverlap:!1,disableOnMobile:!0,exclusionSelectors:"",overlaySelectors:"",topBottom:{...s},leftRight:{...s},top:{...s},right:{...s},bottom:{...s},left:{...s}},c=[{label:(0,o.__)("Solid","visual-grid"),value:"solid"},{label:(0,o.__)("Dashed","visual-grid"),value:"dashed"},{label:(0,o.__)("Dotted","visual-grid"),value:"dotted"}],g=[{label:(0,o.__)("Page Edge","visual-grid"),value:"page"},{label:(0,o.__)("Absolute %","visual-grid"),value:"absolute"},{label:(0,o.__)("Relative %","visual-grid"),value:"relative"}],u=[{label:(0,o.__)("Custom","visual-grid"),value:"custom"},{label:(0,o.__)("Tailwind Style","visual-grid"),value:"tailwind"},{label:(0,o.__)("Modern Grid","visual-grid"),value:"modern"},{label:(0,o.__)("Subtle Lines","visual-grid"),value:"subtle"}];function p({color:t,onChange:l}){const[n,o]=(0,a.useState)(!1);return(0,e.createElement)("div",{className:"visual-grid-color-picker"},(0,e.createElement)(r.Button,{onClick:()=>o(!n),className:"visual-grid-color-button",style:{backgroundColor:t,width:"36px",height:"36px",border:"1px solid #ccc",borderRadius:"4px"}}),n&&(0,e.createElement)(r.Popover,{position:"bottom center",onClose:()=>o(!1)},(0,e.createElement)("div",{style:{padding:"12px"}},(0,e.createElement)(r.ColorPicker,{color:t,onChange:l,enableAlpha:!1}))))}function h({label:t,config:l,onChange:n}){return(0,e.createElement)("div",{className:"visual-grid-side-controls"},(0,e.createElement)("h4",{style:{marginTop:"12px",marginBottom:"8px"}},t),(0,e.createElement)(r.ToggleControl,{label:(0,o.__)("Enable","visual-grid"),checked:l.enabled,onChange:e=>n({...l,enabled:e})}),l.enabled&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{style:{display:"flex",gap:"12px",alignItems:"flex-start",marginBottom:"12px"}},(0,e.createElement)(r.SelectControl,{label:(0,o.__)("Style","visual-grid"),value:l.style,options:c,onChange:e=>n({...l,style:e}),__nextHasNoMarginBottom:!0}),(0,e.createElement)(r.RangeControl,{label:(0,o.__)("Width","visual-grid"),value:l.width,onChange:e=>n({...l,width:e}),min:1,max:10,__nextHasNoMarginBottom:!0})),(0,e.createElement)("div",{style:{display:"flex",gap:"12px",alignItems:"flex-end",marginBottom:"12px"}},(0,e.createElement)("div",null,(0,e.createElement)("label",{className:"components-base-control__label",style:{display:"block",marginBottom:"8px"}},(0,o.__)("Color","visual-grid")),(0,e.createElement)(p,{color:l.color,onChange:e=>n({...l,color:e})})),(0,e.createElement)(r.RangeControl,{label:(0,o.__)("Opacity","visual-grid"),value:l.opacity,onChange:e=>n({...l,opacity:e}),min:0,max:1,step:.05,__nextHasNoMarginBottom:!0})),(0,e.createElement)(r.SelectControl,{label:(0,o.__)("Length Mode","visual-grid"),value:l.lengthMode,options:g,onChange:e=>n({...l,lengthMode:e})}),"page"!==l.lengthMode&&(0,e.createElement)(r.RangeControl,{label:(0,o.__)("Length Percentage","visual-grid"),value:l.lengthPercent,onChange:e=>n({...l,lengthPercent:e}),min:1,max:200})))}function m({visualGrid:t,setAttributes:l}){const n=e=>{l({visualGrid:{...t,...e}})};return(0,e.createElement)(r.PanelBody,{title:(0,o.__)("Visual Grid","visual-grid"),initialOpen:!1,className:"visual-grid-panel"},(0,e.createElement)(r.ToggleControl,{label:(0,o.__)("Enable Visual Grid","visual-grid"),checked:t.enabled,onChange:e=>n({enabled:e})}),t.enabled&&(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r.SelectControl,{label:(0,o.__)("Preset","visual-grid"),value:t.preset,options:u,onChange:e=>{const n=function(e,t){const l=i[e];if(!l||"custom"===e)return{...t,preset:e};const n={enabled:!0,style:l.style,width:l.width,color:l.color,opacity:l.opacity,lengthMode:l.lengthMode,lengthPercent:l.lengthPercent};return{...t,preset:e,topBottom:{...n},leftRight:{...n},top:{...n},right:{...n},bottom:{...n},left:{...n}}}(e,t);l({visualGrid:n})}}),(0,e.createElement)(r.ToggleControl,{label:(0,o.__)("Prevent Line Overlap","visual-grid"),help:(0,o.__)("Prevents duplicate lines from overlapping elements","visual-grid"),checked:t.preventOverlap,onChange:e=>n({preventOverlap:e})}),(0,e.createElement)(r.ToggleControl,{label:(0,o.__)("Disable on Mobile","visual-grid"),help:(0,o.__)("Hide grid lines on mobile devices (< 768px)","visual-grid"),checked:!1!==t.disableOnMobile,onChange:e=>n({disableOnMobile:e})}),(0,e.createElement)(r.TextareaControl,{label:(0,o.__)("Exclusion Selectors (Flow Around)","visual-grid"),help:(0,o.__)("Lines stop before these elements and continue after. Best for transparent elements.","visual-grid"),value:t.exclusionSelectors||"",onChange:e=>n({exclusionSelectors:e}),rows:2}),(0,e.createElement)(r.TextareaControl,{label:(0,o.__)("Overlay Selectors (Cover Lines)","visual-grid"),help:(0,o.__)("These elements appear above the lines. Best for elements with solid backgrounds.","visual-grid"),value:t.overlaySelectors||"",onChange:e=>n({overlaySelectors:e}),rows:2}),(0,e.createElement)("div",{style:{marginBottom:"16px"}},(0,e.createElement)(r.Button,{variant:t.linked?"primary":"secondary",onClick:()=>n({linked:!t.linked}),style:{width:"100%"}},t.linked?(0,o.__)("ðŸ”— Sides Linked","visual-grid"):(0,o.__)("ðŸ”“ Sides Unlinked","visual-grid"))),t.linked?(0,e.createElement)(e.Fragment,null,(0,e.createElement)(h,{label:(0,o.__)("Top & Bottom","visual-grid"),config:t.topBottom||s,onChange:e=>n({topBottom:e})}),(0,e.createElement)(h,{label:(0,o.__)("Left & Right","visual-grid"),config:t.leftRight||s,onChange:e=>n({leftRight:e})})):(0,e.createElement)(r.TabPanel,{className:"visual-grid-tabs",tabs:[{name:"top",title:(0,o.__)("Top","visual-grid")},{name:"right",title:(0,o.__)("Right","visual-grid")},{name:"bottom",title:(0,o.__)("Bottom","visual-grid")},{name:"left",title:(0,o.__)("Left","visual-grid")}]},l=>(0,e.createElement)(h,{label:l.title,config:t[l.name]||s,onChange:e=>n({[l.name]:e})}))))}function b(e,t){const l=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return l?`rgba(${parseInt(l[1],16)}, ${parseInt(l[2],16)}, ${parseInt(l[3],16)}, ${t})`:`rgba(0, 0, 0, ${t})`}function v(e,t){switch(e.lengthMode){case"page":default:return"horizontal"===t?"100vw":"100vh";case"absolute":return"horizontal"===t?`${e.lengthPercent}vw`:`${e.lengthPercent}vh`;case"relative":return`${e.lengthPercent}%`}}function _(e,t,l){const n="horizontal"===l?"90deg":"180deg";switch(e){case"dashed":return`repeating-linear-gradient(${n}, ${t} 0px, ${t} 8px, transparent 8px, transparent 16px)`;case"dotted":return`repeating-linear-gradient(${n}, ${t} 0px, ${t} 2px, transparent 2px, transparent 6px)`;default:return t}}const f=["core/group","core/columns","core/column","core/cover","core/image","core/heading","core/paragraph","kadence/rowlayout","kadence/column","kadence/advancedheading","kadence/iconlist","kadence/tabs","kadence/accordion","simple-morph/glassmorphism-group"];(0,t.addFilter)("blocks.registerBlockType","visual-grid/add-attribute",function(e,t){return f.includes(t)?{...e,attributes:{...e.attributes,visualGrid:{type:"object",default:d}}}:e});const x=(0,l.createHigherOrderComponent)(t=>l=>{const{name:o,attributes:r,setAttributes:i,isSelected:s,clientId:c}=l;if(!f.includes(o))return(0,e.createElement)(t,{...l});const g=r.visualGrid||d,u=(0,a.useMemo)(()=>{if(!g.enabled)return"";let e=function(e){if(!e.enabled)return"";const t='[data-visual-grid-id="PLACEHOLDER"]';let l=`${t} { position: relative; overflow: visible; }\n`,n=null,a=null,o=null,r=null;if(e.linked?(e.topBottom?.enabled&&(n=e.topBottom,a=e.topBottom),e.leftRight?.enabled&&(o=e.leftRight,r=e.leftRight)):(e.top?.enabled&&(n=e.top),e.bottom?.enabled&&(a=e.bottom),e.left?.enabled&&(o=e.left),e.right?.enabled&&(r=e.right)),n){const e=b(n.color,n.opacity),a=v(n,"horizontal"),o=_(n.style,e,"horizontal");l+=`${t}::before {\n  content: '';\n  position: absolute;\n  top: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  width: ${a};\n  height: ${n.width}px;\n  background: ${o};\n  pointer-events: none;\n  z-index: -1;\n}\n`}if(a){const e=b(a.color,a.opacity),n=v(a,"horizontal"),o=_(a.style,e,"horizontal");l+=`${t}::after {\n  content: '';\n  position: absolute;\n  bottom: 0;\n  left: 50%;\n  transform: translateX(-50%);\n  width: ${n};\n  height: ${a.width}px;\n  background: ${o};\n  pointer-events: none;\n  z-index: -1;\n}\n`}if(o||r){let e=[],n=[],a=[];if(o){const t=b(o.color,o.opacity),l=v(o,"vertical"),r=o.width;"solid"===o.style?e.push(`linear-gradient(180deg, ${t}, ${t})`):"dashed"===o.style?e.push(`repeating-linear-gradient(180deg, ${t} 0px, ${t} 8px, transparent 8px, transparent 16px)`):"dotted"===o.style&&e.push(`repeating-linear-gradient(180deg, ${t} 0px, ${t} 2px, transparent 2px, transparent 6px)`),n.push(`${r}px ${l}`),a.push("left center")}if(r){const t=b(r.color,r.opacity),l=v(r,"vertical"),o=r.width;"solid"===r.style?e.push(`linear-gradient(180deg, ${t}, ${t})`):"dashed"===r.style?e.push(`repeating-linear-gradient(180deg, ${t} 0px, ${t} 8px, transparent 8px, transparent 16px)`):"dotted"===r.style&&e.push(`repeating-linear-gradient(180deg, ${t} 0px, ${t} 2px, transparent 2px, transparent 6px)`),n.push(`${o}px ${l}`),a.push("right center")}e.length>0&&(l+=`${t} {\n  background-image: ${e.join(", ")};\n  background-size: ${n.join(", ")};\n  background-position: ${a.join(", ")};\n  background-repeat: no-repeat;\n}\n`)}return l}(g);return e.replace(/\[data-visual-grid-id="PLACEHOLDER"\]/g,`[data-block="${c}"]`)},[g,c]);return(0,e.createElement)(a.Fragment,null,(0,e.createElement)(t,{...l}),s&&(0,e.createElement)(n.InspectorControls,null,(0,e.createElement)(m,{visualGrid:g,setAttributes:i})),g.enabled&&u&&(0,e.createElement)("style",null,u))},"withVisualGridControls");(0,t.addFilter)("editor.BlockEdit","visual-grid/with-controls",x),(0,t.addFilter)("blocks.getSaveContent.extraProps","visual-grid/add-data-attributes",function(e,t,l){if(!f.includes(t.name))return e;const n=l.visualGrid;return n?.enabled?{...e,"data-visual-grid":JSON.stringify(n),className:`${e.className||""} has-visual-grid`.trim()}:e})})();